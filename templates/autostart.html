{% extends 'base.html' %}
{% block content %}
<h2 class="mb-4">ğŸ”„ systemd å¼€æœºè‡ªå¯ç®¡ç†</h2>

{% if message %}
<div class="alert alert-info">{{ message }}</div>
{% endif %}

<form method="post" class="mb-4">
  <div class="mb-3">
    <label class="form-label">æœåŠ¡åç§°ï¼ˆä¸å¸¦åç¼€ .serviceï¼‰</label>
    <input type="text" name="name" class="form-control" placeholder="myapp" required>
  </div>

  <div class="mb-3">
    <label class="form-label">å¯åŠ¨å‘½ä»¤</label>
    <input type="text" name="command" class="form-control" placeholder="/home/tgu/myscript.sh" required>
  </div>

  <div class="mb-3">
    <label class="form-label">è¿è¡Œè·¯å¾„ï¼ˆå¯é€‰ WorkingDirectoryï¼‰</label>
    <input type="text" name="workdir" class="form-control" placeholder="/home/tgu/myproject">
  </div>

  <div class="mb-3">
    <label class="form-label">ç¯å¢ƒå˜é‡ï¼ˆEnvironmentï¼Œæ ¼å¼ä¸€è¡Œä¸€æ¡ï¼Œä¾‹å¦‚ï¼š<code>HOME=/home/tgu</code>ï¼‰</label>
    <textarea name="environment" class="form-control" rows="4" placeholder="HOME=/home/tgu\nPATH=/usr/local/bin:/usr/bin:/bin"></textarea>
  </div>

  <button type="submit" class="btn btn-primary">åˆ›å»ºå¹¶å¯ç”¨æœåŠ¡</button>
</form>

<h4>ğŸ“ å·²æ³¨å†ŒæœåŠ¡ï¼š</h4>
<table class="table table-striped">
  <thead>
    <tr>
      <th>æœåŠ¡åç§°</th>
      <th>çŠ¶æ€</th>
      <th>æ“ä½œ</th>
    </tr>
  </thead>
  <tbody>
    {% for svc in files %}
    <tr>
      <td>{{ svc.name }}</td>
      <td>
        {% if svc.status == 'active' %}
          <span class="badge bg-success">è¿è¡Œä¸­</span>
        {% elif svc.status == 'inactive' %}
          <span class="badge bg-secondary">å·²åœæ­¢</span>
        {% elif svc.status == 'failed' %}
          <span class="badge bg-danger">å¤±è´¥</span>
        {% else %}
          <span class="badge bg-warning text-dark">æœªçŸ¥</span>
        {% endif %}
      </td>
      <td>
        {% if svc.status != 'active' %}
          <a href="{{ url_for('autostart.enable_service', name=svc.name) }}" class="btn btn-sm btn-success">å¯ç”¨</a>
        {% endif %}
        <a href="{{ url_for('autostart.stop_service', name=svc.name) }}" class="btn btn-sm btn-warning">åœæ­¢</a>
        <a href="{{ url_for('autostart.disable_service', name=svc.name) }}" class="btn btn-sm btn-danger">ç¦ç”¨</a>
        <a href="{{ url_for('autostart.delete_service', name=svc.name) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('ç¡®å®šåˆ é™¤æœåŠ¡ {{ svc.name }} å—ï¼Ÿ');">åˆ é™¤</a>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="3">æš‚æ— æœåŠ¡</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
