{% extends "base.html" %}

{% block title %}ç£ç›˜ç®¡ç†{% endblock %}

{% block content %}
  <h2>ç£ç›˜å®¹é‡ç®¡ç†</h2>

  <!-- æ€»ä½“å®¹é‡æ˜¾ç¤º -->
  <p>æ€»å®¹é‡: {{ total }} GB</p>
  <p>å·²ç”¨: {{ used }} GB</p>
  <p>å‰©ä½™: {{ free }} GB</p>
  <p>ä½¿ç”¨ç‡: {{ percent_used }}%</p>

  <div class="progress mb-4" style="height: 25px; max-width: 500px;">
    <div class="progress-bar" role="progressbar" style="width: {{ percent_used }}%;" aria-valuenow="{{ percent_used }}" aria-valuemin="0" aria-valuemax="100">
      {{ percent_used }}%
    </div>
  </div>

  <!-- æ¸…ç†æŒ‰é’® -->
  <form method="post" action="{{ url_for('diskmanager.clean_tmp') }}" onsubmit="return confirm('ç¡®å®šè¦æ¸…ç† /tmp ç›®å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')">
    <button type="submit" class="btn btn-danger">ğŸ§¹ æ¸…ç† /tmp ç›®å½•</button>
  </form>

  <!-- é—ªç°æç¤º -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="mt-3">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <!-- åˆ†éš”çº¿ -->
  <hr class="my-4">

  <!-- æ ¹ç›®å½•å„æ–‡ä»¶å¤¹ç£ç›˜ä½¿ç”¨æƒ…å†µ -->
  <h4>ğŸ“‚ æ ¹ç›®å½•å„æ–‡ä»¶å¤¹å ç”¨æƒ…å†µ</h4>
  <ul class="list-group">
    {% for folder in folder_usage %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>/{{ folder.name }}</span>
        <div style="flex: 1; margin: 0 10px;">
          <div class="progress">
            <div class="progress-bar bg-info" role="progressbar" style="width: {{ folder.percent|round(2) }}%;" aria-valuenow="{{ folder.percent }}" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
        </div>
        <span>{{ (folder.size / (1024**2)) | round(1) }} MB</span>
      </li>
    {% endfor %}
  </ul>
{% endblock %}
